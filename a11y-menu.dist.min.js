"use strict";!function(t){var e={init:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this;r.setOptions(t),r.getContainers().length&&r.getOption("expanded_class")&&(r.polyfill(),r.getContainers().forEach(function(t){var e=t.querySelectorAll(r.getOption("child_menu_selector"));if(Object.keys(e).length){var a=r.getButton(r.getOption("button_attributes"));e.forEach(function(t){var e=t.parentNode,n=a.cloneNode(!0);e.setAttribute("aria-haspopup","true"),e.insertBefore(n,t);var o=e.querySelector("a[href]");null!=o&&o.addEventListener("touchstart",function(t){return r.onTouch(t)},!0)}),t.addEventListener("focusin",function(t){return r.onFocus(t)},!0),t.addEventListener("focusout",function(t){return r.onFocus(t)},!0);var n=r.getOption("button_selector");n&&t.querySelectorAll(n).forEach(function(t){t.addEventListener("mousedown",function(t){return r.onClick(t)})}),document.addEventListener("keydown",function(t){return r.onKeydown(t)})}}))},onFocus:function(t){var e=this,n=e.getParents(t);"focusin"===t.type?n.map(function(t){return t.classList.add(e.getOption("expanded_class"))}):n.map(function(t){return t.classList.remove(e.getOption("expanded_class"))}),e.changeButtonAttributes(t)},onClick:function(t){var e=this,n=e.getOption("expanded_class"),o=t.target.parentNode,a=o.classList.contains(n);e.getSiblings(o).map(function(t){return t.classList.remove(n)}),a?o.classList.remove(n):o.classList.add(n),e.changeButtonAttributes(t)},onTouch:function(t){var e=this,n=t.target,o=n.parentNode;o.classList.contains(e.getOption("expanded_class"))?n!==document.activeElement&&(t.preventDefault(),o.classList.remove(e.getOption("expanded_class")),e.changeButtonAttributes(t)):(t.preventDefault(),n.focus())},onKeydown:function(t){if(27===t.keyCode){var e=this,n=e.getOption("expanded_class");e.getContainers().forEach(function(t){t.querySelectorAll("."+n).forEach(function(t){t.classList.remove(n),e.changeButtonAttributes(t)})})}},getContainers:function(){var e=this,t=e.getOption("menu_selector");return!e.menus.length&&t&&document.querySelectorAll(t).forEach(function(t){return e.menus.push(t)}),e.menus},getSiblings:function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'[aria-haspopup="true"]',n=[],o=t.parentNode.firstChild;o;o=o.nextElementSibling)1===o.nodeType&&o.matches(e)&&t!==o&&n.push(o);return n},getParents:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'[aria-haspopup="true"]',n=[];if(null!=t.path){n=t.path;for(var o=this.getContainers(),a=void 0,r=0,i=o.length;r<i&&-1===(a=n.indexOf(o[r]));r++);n.splice(a),n.shift()}else for(var s=1===t.nodeType?t:t.target,u=this.getContainers();-1===u.indexOf(s);)n.push(s),s=s.parentNode;return e&&(n=n.filter(function(t){return t.matches(e)})),n},getButton:function(e){e=e||{};var t=Object.keys(e);if(t.length){var n=document.createElement("button"),o=["class","tabindex","title"];return n.setAttribute("aria-expanded","false"),t.forEach(function(t){-1===o.indexOf(t)&&0!==t.indexOf("aria-")&&0!==t.indexOf("data-")||n.setAttribute(t.toLowerCase(),e[t])}),null!=e["aria-label"]&&null!=e["aria-label"].expand&&n.setAttribute("aria-label",e["aria-label"].expand),n}},changeButtonAttributes:function(t){var e=1===t.nodeType?t:t.target.parentNode,n=void 0;if(null!=e&&(n=e.querySelector(this.getOption("button_selector"))),null!=n&&1===n.nodeType){var o=e.classList.contains(this.getOption("expanded_class")),a=this.getOption("button_attributes","aria-label");"string"!=typeof a&&null!=a&&(o&&null!=a.collapse?n.setAttribute("aria-label",a.collapse):o||null==a.expand||n.setAttribute("aria-label",a.expand)),n.setAttribute("aria-expanded",o.toString())}},setOptions:function(t){var e={button_attributes:{class:"button-toggle-sub-menu","aria-label":{collapse:"Collapse child menu",expand:"Expand child menu"}},button_selector:"button[aria-expanded]",child_menu_selector:".sub-menu",expanded_class:"has-expanded-sub-menu",menu_selector:"nav .menu"};for(var n in t)e.hasOwnProperty(n)&&(e[n]="expanded_class"===n?t[n].replace(/[^a-zA-Z0-9\-_]/g,""):t[n]);this.options=e,this.menus=[]},getOption:function(){var t=this.options,e=arguments,n=e.length;if(1===n)t=null!=t[e[0]]&&t[e[0]];else for(var o=0;o<n;o++)t=null!=t[e[o]]&&t[e[o]];return t},polyfill:function(){window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector)}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){return e.init(t)}):e.init(t)}(window.a11yMenuConfig||{});