"use strict";!function(e){var t={init:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=this;o.setArgs(e),o.getContainers().length&&o.getArg("expanded-class")&&o.getContainers().forEach(function(e){var t=e.querySelectorAll(o.getArg("child-menu-selector"));if(Object.keys(t).length){var a=o.getButton(o.args["button-attributes"]);t.forEach(function(e){var t=e.parentNode,n=a.cloneNode(!0);t.setAttribute("aria-haspopup","true"),t.insertBefore(n,e);var r=t.querySelector("a[href]");null!=r&&r.addEventListener("touchstart",function(e){return o.onTouch(e)},!0)}),e.addEventListener("focusin",function(e){return o.onFocus(e)},!0),e.addEventListener("focusout",function(e){return o.onFocus(e)},!0);var n=o.getArg("button-selector");n&&e.querySelectorAll(n).forEach(function(e){e.addEventListener("mousedown",function(e){return o.onClick(e)})}),document.addEventListener("keydown",function(e){return o.onKeydown(e)})}})},onFocus:function(e){var t=this,n=t.getParents(e);"focusin"===e.type?n.map(function(e){e.classList.add(t.getArg("expanded-class"))}):n.map(function(e){e.classList.remove(t.getArg("expanded-class"))}),t.changeButtonAttributes(e)},onClick:function(e){var t=this,n=t.getArg("expanded-class"),r=e.target.parentNode,a=r.classList.contains(n),o=t.getSiblings(r);(o=o.filter(function(e){return e.matches('[aria-haspopup="true"]')})).map(function(e){return e.classList.remove(n)}),a?r.classList.remove(n):r.classList.add(n),t.changeButtonAttributes(e)},onTouch:function(e){var t=e.target,n=t.parentNode;n.classList.contains(this.getArg("expanded-class"))?t!==document.activeElement&&(e.preventDefault(),n.classList.remove(this.getArg("expanded-class"))):(e.preventDefault(),t.focus())},onKeydown:function(e){if(27===e.keyCode){var t=this,n=t.getArg("expanded-class");t.getContainers().forEach(function(e){e.querySelectorAll("."+n).forEach(function(e){e.classList.remove(n),t.changeButtonAttributes(e)})})}},getContainers:function(){var t=this,e=t.getArg("menu-selector");return!t.menus.length&&e&&document.querySelectorAll(e).forEach(function(e){return t.menus.push(e)}),t.menus},getSiblings:function(e){for(var t=[],n=e.parentNode.firstChild;n;n=n.nextSibling)1===n.nodeType&&n!==e&&t.push(n);return t},getParents:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'[aria-haspopup="true"]',n=[];if(null!=e.path){n=e.path;for(var r=this.getContainers(),a=void 0,o=0,s=r.length;o<s&&-1===(a=n.indexOf(r[o]));o++);n.splice(a),n.shift()}else for(var i=1===e.nodeType?e:e.target,u=this.getContainers();-1===u.indexOf(i);)n.push(i),i=i.parentNode;return t&&(n=n.filter(function(e){return e.matches(t)})),n},getButton:function(t){t=t||{};var e=Object.keys(t);if(e.length){var n=document.createElement("button"),r=["class","tabindex","title"];return n.setAttribute("aria-expanded","false"),e.forEach(function(e){-1===r.indexOf(e)&&0!==e.indexOf("aria-")&&0!==e.indexOf("data-")||n.setAttribute(e.toLowerCase(),t[e])}),null!=t["aria-label"]&&null!=t["aria-label"].expand&&n.setAttribute("aria-label",t["aria-label"].expand),n}},changeButtonAttributes:function(e){var t=1===e.nodeType?e:e.target.parentNode,n=void 0;if(null!=t&&(n=t.querySelector(this.getArg("button-selector"))),null!=n&&1===n.nodeType){var r=t.classList.contains(this.getArg("expanded-class")),a=this.getArg("button-attributes","aria-label");null!=a&&(r&&null!=a.collapse?n.setAttribute("aria-label",a.collapse):r||null==a.expand||n.setAttribute("aria-label",a.expand)),n.setAttribute("aria-expanded",r.toString())}},setArgs:function(e){var t={"button-attributes":{class:"button-toggle-sub-menu","aria-label":{collapse:"Collapse child menu",expand:"Expand child menu"}},"button-selector":"button[aria-expanded]","child-menu-selector":".sub-menu","expanded-class":"has-expanded-sub-menu","menu-selector":".toggle-sub-menus"};for(var n in e)t.hasOwnProperty(n)&&(t[n]="expanded-class"===n?e[n].replace(/[^a-zA-Z0-9\-_]/g,""):e[n]);this.args=t,this.menus=[]},getArg:function(){for(var e=arguments,t=this.args,n=0,r=e.length;n<r;n++)t=t.hasOwnProperty(e[n])?t[e[n]]:{};return"string"==typeof t?t:""}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){return t.init(e)}):t.init(e)}(window.a11yMenuConfig||{}),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);