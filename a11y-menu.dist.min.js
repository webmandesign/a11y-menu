"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){var e={init:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=this;a.setArgs(t),a.getContainers().length&&a.getArg("expanded_class")&&(a.polyfill(),a.getContainers().forEach(function(t){var e=t.querySelectorAll(a.getArg("child_menu_selector"));if(Object.keys(e).length){var o=a.getButton(a.getArg("button_attributes"));e.forEach(function(t){var e=t.parentNode,n=o.cloneNode(!0);e.setAttribute("aria-haspopup","true"),e.insertBefore(n,t);var r=e.querySelector("a[href]");null!=r&&r.addEventListener("touchstart",function(t){return a.onTouch(t)},!0)}),t.addEventListener("focusin",function(t){return a.onFocus(t)},!0),t.addEventListener("focusout",function(t){return a.onFocus(t)},!0);var n=a.getArg("button_selector");n&&t.querySelectorAll(n).forEach(function(t){t.addEventListener("mousedown",function(t){return a.onClick(t)})}),document.addEventListener("keydown",function(t){return a.onKeydown(t)})}}))},onFocus:function(t){var e=this,n=e.getParents(t);"focusin"===t.type?n.map(function(t){return t.classList.add(e.getArg("expanded_class"))}):n.map(function(t){return t.classList.remove(e.getArg("expanded_class"))}),e.changeButtonAttributes(t)},onClick:function(t){var e=this,n=e.getArg("expanded_class"),r=t.target.parentNode,o=r.classList.contains(n);e.getSiblings(r).map(function(t){return t.classList.remove(n)}),o?r.classList.remove(n):r.classList.add(n),e.changeButtonAttributes(t)},onTouch:function(t){var e=this,n=t.target,r=n.parentNode;r.classList.contains(e.getArg("expanded_class"))?n!==document.activeElement&&(t.preventDefault(),r.classList.remove(e.getArg("expanded_class")),e.changeButtonAttributes(t)):(t.preventDefault(),n.focus())},onKeydown:function(t){if(27===t.keyCode){var e=this,n=e.getArg("expanded_class");e.getContainers().forEach(function(t){t.querySelectorAll("."+n).forEach(function(t){t.classList.remove(n),e.changeButtonAttributes(t)})})}},getContainers:function(){var e=this,t=e.getArg("menu_selector");return!e.menus.length&&t&&document.querySelectorAll(t).forEach(function(t){return e.menus.push(t)}),e.menus},getSiblings:function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'[aria-haspopup="true"]',n=[],r=t.parentNode.firstChild;r;r=r.nextSibling)r.matches(e)&&t!==r&&n.push(r);return n},getParents:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'[aria-haspopup="true"]',n=[];if(null!=t.path){n=t.path;for(var r=this.getContainers(),o=void 0,a=0,s=r.length;a<s&&-1===(o=n.indexOf(r[a]));a++);n.splice(o),n.shift()}else for(var i=1===t.nodeType?t:t.target,u=this.getContainers();-1===u.indexOf(i);)n.push(i),i=i.parentNode;return e&&(n=n.filter(function(t){return t.matches(e)})),n},getButton:function(e){e=e||{};var t=Object.keys(e);if(t.length){var n=document.createElement("button"),r=["class","tabindex","title"];return n.setAttribute("aria-expanded","false"),t.forEach(function(t){-1===r.indexOf(t)&&0!==t.indexOf("aria-")&&0!==t.indexOf("data-")||n.setAttribute(t.toLowerCase(),e[t])}),null!=e["aria-label"]&&null!=e["aria-label"].expand&&n.setAttribute("aria-label",e["aria-label"].expand),n}},changeButtonAttributes:function(t){var e=1===t.nodeType?t:t.target.parentNode,n=void 0;if(null!=e&&(n=e.querySelector(this.getArg("button_selector"))),null!=n&&1===n.nodeType){var r=e.classList.contains(this.getArg("expanded_class")),o=this.getArg("button_attributes","aria-label");null!=o&&"object"===(void 0===o?"undefined":_typeof(o))&&(r&&null!=o.collapse?n.setAttribute("aria-label",o.collapse):r||null==o.expand||n.setAttribute("aria-label",o.expand)),n.setAttribute("aria-expanded",r.toString())}},setArgs:function(t){var e={button_attributes:{class:"button-toggle-sub-menu","aria-label":{collapse:"Collapse child menu",expand:"Expand child menu"}},button_selector:"button[aria-expanded]",child_menu_selector:".sub-menu",expanded_class:"has-expanded-sub-menu",menu_selector:"nav .menu"};for(var n in t)e.hasOwnProperty(n)&&(e[n]="expanded_class"===n?t[n].replace(/[^a-zA-Z0-9\-_]/g,""):t[n]);this.args=e,this.menus=[]},getArg:function(){for(var t=this.args,e=0,n=arguments.length;e<n;e++)t=!!t.hasOwnProperty(arguments[e])&&t[arguments[e]];return t},polyfill:function(){window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector)}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){return e.init(t)}):e.init(t)}(window.a11yMenuConfig||{});